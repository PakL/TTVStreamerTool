

<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>mod/tool.js &bull; TTVStreamerTool</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="https://fonts.googleapis.com/css?family=Muli:100,400,700|Oswald:300|Inconsolata,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
    <link type="text/css" rel="stylesheet" href="styles/app.min.css">
</head>

<body>
    <div id="stickyNavbarOverlay"></div>
    <div class="top-navbar">
        <div class="container">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                     
                        <img src="img/logomark-white.svg" alt="logo">
                    
                     
                        <h1 class="navbar-item">TTVStreamerTool</h1>
                    
                    <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                 
                <div class="navbar-menu">
                    <div class="navbar-end">
                    
                        <div class="navbar-item">
                            <a href="https://github.com/PakL/TTVStreamerTool" target="_blank">Github</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://pakl.dev/" target="_blank">pakl.dev</a>
                        </div>
                    
                        <div class="navbar-item">
                            <a href="https://dieweltzockt.de/" target="_blank">Die Welt Zockt</a>
                        </div>
                    
                    </div>
                </div>
                
            </nav>
        </div>
    </div>
    <div class="container">
        <div class="columns">
            <div class="column is-3" id="sidebarNav">
                <div class="sidebar">
                    <nav>
                        <h2><a href="index.html">Home</a></h2><div class="category"><h3>Tutorials</h3><ul><li><a href="tutorial-Getting Started.html">Getting Started</a></li><li><a href="tutorial-Streamdeck Shortcuts.html">Streamdeck Shortcuts</a></li></ul><h3>Classes</h3><ul><li><a href="Addons.html">Addons</a></li><li><a href="Channel.html">Channel</a></li><li><a href="Chat.html">Chat</a></li><li><a href="Cockpit.html">Cockpit</a></li><li><a href="Follows.html">Follows</a></li><li><a href="Overlays.html">Overlays</a></li><li><a href="ToolSettings.html">ToolSettings</a></li><li><a href="ToolUI.html">ToolUI</a></li><li><a href="TTVLogin.html">TTVLogin</a></li><li><a href="TTVTool.html">TTVTool</a></li><li><a href="TwitchChat.html">TwitchChat</a></li><li><a href="TwitchHelix.html">TwitchHelix</a></li><li><a href="TwitchTv.html">TwitchTv</a></li><li><a href="UIPage.html">UIPage</a></li></ul><h3>Events</h3><ul><li><a href="Channel.html#event:channeloffline">channeloffline</a></li><li><a href="Channel.html#event:channelonline">channelonline</a></li><li><a href="Channel.html#event:gamechange">gamechange</a></li><li><a href="Channel.html#event:statuschange">statuschange</a></li><li><a href="Channel.html#event:viewers">viewers</a></li><li><a href="Chat.html#event:autohostingyou">autohostingyou</a></li><li><a href="Chat.html#event:chatmessage">chatmessage</a></li><li><a href="Chat.html#event:cheer">cheer</a></li><li><a href="Chat.html#event:clearchat">clearchat</a></li><li><a href="Chat.html#event:clearuser">clearuser</a></li><li><a href="Chat.html#event:connected">connected</a></li><li><a href="Chat.html#event:hostingyou">hostingyou</a></li><li><a href="Chat.html#event:join">join</a></li><li><a href="Chat.html#event:names">names</a></li><li><a href="Chat.html#event:part">part</a></li><li><a href="Chat.html#event:roomstate">roomstate</a></li><li><a href="Chat.html#event:sendmessage">sendmessage</a></li><li><a href="Chat.html#event:usernotice">usernotice</a></li><li><a href="Chat.html#event:userstate">userstate</a></li><li><a href="Cockpit.html#event:channelleft">channelleft</a></li><li><a href="Cockpit.html#event:channelopen">channelopen</a></li><li><a href="Follows.html#event:follow">follow</a></li><li><a href="Overlays.html#event:command">command</a></li><li><a href="Overlays.html#event:hotkeys-unregistered">hotkeys-unregistered</a></li><li><a href="TTVLogin.html#event:complete">complete</a></li><li><a href="TTVTool.html#event:exit">exit</a></li><li><a href="TTVTool.html#event:load">load</a></li><li><a href="TwitchChat.html#event:action">action</a></li><li><a href="TwitchChat.html#event:autohostingyou">autohostingyou</a></li><li><a href="TwitchChat.html#event:capack">capack</a></li><li><a href="TwitchChat.html#event:clearchat">clearchat</a></li><li><a href="TwitchChat.html#event:clearmsg">clearmsg</a></li><li><a href="TwitchChat.html#event:clearuser">clearuser</a></li><li><a href="TwitchChat.html#event:close">close</a></li><li><a href="TwitchChat.html#event:connect">connect</a></li><li><a href="TwitchChat.html#event:error">error</a></li><li><a href="TwitchChat.html#event:hostingyou">hostingyou</a></li><li><a href="TwitchChat.html#event:incoming">incoming</a></li><li><a href="TwitchChat.html#event:join">join</a></li><li><a href="TwitchChat.html#event:message">message</a></li><li><a href="TwitchChat.html#event:mode">mode</a></li><li><a href="TwitchChat.html#event:mode+">mode+</a></li><li><a href="TwitchChat.html#event:mode-">mode-</a></li><li><a href="TwitchChat.html#event:motd">motd</a></li><li><a href="TwitchChat.html#event:names">names</a></li><li><a href="TwitchChat.html#event:notice">notice</a></li><li><a href="TwitchChat.html#event:outgoing">outgoing</a></li><li><a href="TwitchChat.html#event:part">part</a></li><li><a href="TwitchChat.html#event:raw">raw</a></li><li><a href="TwitchChat.html#event:reconnect">reconnect</a></li><li><a href="TwitchChat.html#event:registered">registered</a></li><li><a href="TwitchChat.html#event:roomstate">roomstate</a></li><li><a href="TwitchChat.html#event:usernotice">usernotice</a></li><li><a href="TwitchChat.html#event:userstate">userstate</a></li><li><a href="TwitchChat.html#event:whisper">whisper</a></li></ul></div>
                    </nav>
                </div>
            </div>
            <div class="column is-9-desktop">
                <div class="content" id="main-content-wrapper">
                    <header class="page-title">
                        <p>Source</p>
                        <h1>mod/tool.js</h1>
                    </header>
                    
                    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const {remote} = require('electron')
const EventEmitter = require('events')
const i18n = require('../node_modules/i18n-nodejs')

const ToolUI = require('./toolui')
const ToolSettings = require('../lib/settings')
const TwitchTv = require('./twitchtv')
const TwitchHelix = require('./twitchhelix')
const TTVLogin = require('../lib/auth')
const Chat = require('../lib/chat')

const Channel = require('../var/channel')
const Follows = require('../var/follows')
const Subscriptions = require('../var/subscriptions')

const Addons = require('../lib/addons')
//const EAU = remote.require('electron-asar-updater')
const {app, autoUpdater} = remote.require('electron')
const spawn = require('child_process').spawn;

/**
 * This module initializes pretty much everything and other modules have access to other modules over here.
 * 
 * @class TTVTool
 * @fires TTVTool#load
 * @fires TTVTool#exit
 * @extends {EventEmitter}
 */
class TTVTool extends EventEmitter {

	constructor() {
		super()
		const self = this

		this.setMaxListeners(50)


		this._loaded = false
		this._settings = new ToolSettings(this)
		this._i18n = new i18n(this._settings.language, './../../language.json')
		this._twitchapi = new TwitchTv({
			clientid: '11vhuxdssb9pc3s2uqpa7s3s0252hyk',
			redirecturi: 'http://localhost:8086/',
			scope: [
				'user:read:email',
				'chat:read',
				'chat:edit',
				'whispers:read',
				'whispers:edit',
				'user:edit:broadcast',
				'channel:read:subscriptions',
				'channel:moderate',
				'user_read',
				'channel_check_subscription',
				'channel_editor',
				'channel_read'
			]
		})
		this._twitchhelix = new TwitchHelix({
			clientid: '11vhuxdssb9pc3s2uqpa7s3s0252hyk',
			redirecturi: 'http://localhost:8086/',
			scope: []
		})
		this._auth = new TTVLogin(this)
		this._chat = new Chat(this)

		this._ui = new ToolUI(this)
		this._ui.addPage(this._settings)
		
		this._channel = new Channel(this)
		this._follows = new Follows(this)
		// All subscriptions are coming via chat now
		//this._subscriptions = new Subscriptions(this)

		this._addons = new Addons(this)

		this.once('load', () => {
			if(self._settings.lightDesignMode) {
				document.querySelector('body').classList.add('invert')
			}
		})

		window.onload = async (e) => {
			riot.install((c) => {
				c.makeAccessible = () => { c.root._tag = c }
				return c
			})
			await riot.compile()

			document.querySelectorAll('script[type=riot]').forEach((rt) => {
				rt.remove()
			})

			/**
			 * Fires after the document was loaded. Basically window.onload. Use this instead
			 * of window.onload to not overwrite the onload function and breaking the entire
			 * application. Thank you. :)
			 * 
			 * @event TTVTool#load
			 */
			self.emit('load')
			self._loaded = true
		}
		window.onbeforeunload = (e) => {
			/**
			 * Fires before the application is exited. Once again just window.onbeforeunload.
			 * Don't overwrite window.onbeforeunload please.
			 * 
			 * @event TTVTool#exit
			 */
			self.emit('exit')
		}

		
	}

	/**
	 * Was the load event fired
	 * 
	 * @type {Boolean}
	 * @readonly
	 */
	get loaded()
	{
		return this._loaded
	}

	/**
	 * Gives you the UI modules
	 * 
	 * @type {ToolUI}
	 * @readonly
	 */
	get ui() {
		return this._ui
	}

	/**
	 * Gives you the {@link https://www.npmjs.com/package/i18n-nodejs|i18n-nodejs} module.
	 * 
	 * @type {i18n-nodejs}
	 * @see {@link https://www.npmjs.com/package/i18n-nodejs}
	 * @readonly
	 */
	get i18n() {
		return this._i18n
	}

	/**
	 * Gives you the settings module.
	 * 
	 * @type {ToolSettings}
	 * @readonly
	 */
	get settings() {
		return this._settings
	}

	/**
	 * Gives you the Twitch-API module.
	 * 
	 * @type {TwitchTv}
	 * @readonly
	 */
	get twitchapi() {
		return this._twitchapi
	}

	/**
	 * Gives you the new Twitch API module
	 * 
	 * @type {TwitchHelix}
	 * @readonly
	 */
	get twitchhelix() {
		return this._twitchhelix
	}
	
	/**
	 * Gives you the auth module.
	 * 
	 * @type {TTVLogin}
	 * @readonly
	 */
	get auth() {
		return this._auth
	}

	/**
	 * Gives you the chat module.
	 * 
	 * @type {Chat}
	 * @readonly
	 */
	get chat() {
		return this._chat
	}

	/**
	 * Gives you the cockpit module.
	 * 
	 * @type {Cockpit}
	 * @readonly
	 */
	get cockpit() {
		return this._ui.findPage('Cockpit')
	}

	/**
	 * Gives you the overlay module.
	 * 
	 * @type {TTVLogin}
	 * @readonly
	 */
	get overlays() {
		return this._ui.findPage('Overlays')
	}

	/**
	 * Gives you the channel data module.
	 * 
	 * @type {Channel}
	 * @readonly
	 */
	get channel() {
		return this._channel
	}

	/**
	 * Gives you the follow data module.
	 * 
	 * @type {Follows}
	 * @readonly
	 */
	get follows() {
		return this._follows
	}

	/**
	 * Gives you a subscription module.
	 * 
	 * @type {undefined}
	 * @readonly
	 * @deprecated Subscription are now shared with everyone via chat.
	 */
	get subscriptions() {
		return this._subscriptions
	}

	/**
	 * Gives you the addons module.
	 * 
	 * @type {Addons}
	 * @readonly
	 */
	get addons() {
		return this._addons
	}

}

const tool = new TTVTool()
module.exports = tool</code></pre>
        </article>
    </section>




                </div>
            </div>
        </div>
    </div>

<footer class="footer">
    <div class="content has-text-centered">
        <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.3</a> on Mon Jul 29 2019 17:48:54 GMT+0200 (GMT+02:00)</p>
        <p class="sidebar-created-by">
            <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by 
            <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers</a>
        </p>
    </div>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/app.min.js"></script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
