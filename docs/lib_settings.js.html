

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: lib/settings.js | TTVST</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 0px; height: 0px">
        <img src="img/toast-ui.png" width="100%" height="100%">
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">TTVST</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Tutorials</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Tutorials</h3><ul><li><a href="tutorial-Getting Started.html">Getting Started</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Getting Started_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Addons.html">Addons</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Addons_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Addons.html#menu">menu</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Addons.html#addonInstalled">addonInstalled</a></li><li><a href="Addons.html#getAddon">getAddon</a></li><li><a href="Addons.html#getInstalledAddonVersion">getInstalledAddonVersion</a></li></ul></div></li><li><a href="Channel.html">Channel</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Channel_sub"><div class="member-type">Events</div><ul class="inner"><li><a href="Channel.html#event:channeloffline">channeloffline</a></li><li><a href="Channel.html#event:channelonline">channelonline</a></li><li><a href="Channel.html#event:gamechange">gamechange</a></li><li><a href="Channel.html#event:statuschange">statuschange</a></li><li><a href="Channel.html#event:viewers">viewers</a></li></ul></div></li><li><a href="Chat.html">Chat</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Chat_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Chat.html#connected">connected</a></li><li><a href="Chat.html#irc">irc</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Chat.html#auth">auth</a></li><li><a href="Chat.html#disconnect">disconnect</a></li><li><a href="Chat.html#getUserObjByTags">getUserObjByTags</a></li><li><a href="Chat.html#join">join</a></li><li><a href="Chat.html#part">part</a></li><li><a href="Chat.html#sendmsg">sendmsg</a></li><li><a href="Chat.html#showmsg">showmsg</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="Chat.html#event:autohostingyou">autohostingyou</a></li><li><a href="Chat.html#event:chatmessage">chatmessage</a></li><li><a href="Chat.html#event:clearchat">clearchat</a></li><li><a href="Chat.html#event:clearuser">clearuser</a></li><li><a href="Chat.html#event:connected">connected</a></li><li><a href="Chat.html#event:hostingyou">hostingyou</a></li><li><a href="Chat.html#event:join">join</a></li><li><a href="Chat.html#event:names">names</a></li><li><a href="Chat.html#event:part">part</a></li><li><a href="Chat.html#event:usernotice">usernotice</a></li><li><a href="Chat.html#event:userstate">userstate</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="Chat.html#~userObject">userObject</a></li></ul></div></li><li><a href="Cockpit.html">Cockpit</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Cockpit_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Cockpit.html#isChannelOnline">isChannelOnline</a></li><li><a href="Cockpit.html#localizedName">localizedName</a></li><li><a href="Cockpit.html#name">name</a></li><li><a href="Cockpit.html#openChannelId">openChannelId</a></li><li><a href="Cockpit.html#openChannelObject">openChannelObject</a></li><li><a href="Cockpit.html#showInViewsList">showInViewsList</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Cockpit.html#close">close</a></li><li><a href="Cockpit.html#leaveChannel">leaveChannel</a></li><li><a href="Cockpit.html#loadMoreFollows">loadMoreFollows</a></li><li><a href="Cockpit.html#open">open</a></li><li><a href="Cockpit.html#openChannel">openChannel</a></li><li><a href="Cockpit.html#searchGame">searchGame</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="Cockpit.html#event:channelleft">channelleft</a></li><li><a href="Cockpit.html#event:channelopen">channelopen</a></li></ul></div></li><li><a href="Follows.html">Follows</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Follows_sub"><div class="member-type">Events</div><ul class="inner"><li><a href="Follows.html#event:follow">follow</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="Follows.html#~userObject">userObject</a></li></ul></div></li><li><a href="Overlays.html">Overlays</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Overlays_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Overlays.html#allowedFiles">allowedFiles</a></li><li><a href="Overlays.html#localizedName">localizedName</a></li><li><a href="Overlays.html#name">name</a></li><li><a href="Overlays.html#overlayport">overlayport</a></li><li><a href="Overlays.html#overlayserver">overlayserver</a></li><li><a href="Overlays.html#showInViewsList">showInViewsList</a></li><li><a href="Overlays.html#wsport">wsport</a></li><li><a href="Overlays.html#wsserver">wsserver</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Overlays.html#broadcastWsMessage">broadcastWsMessage</a></li><li><a href="Overlays.html#close">close</a></li><li><a href="Overlays.html#disableOverlayHotkeys">disableOverlayHotkeys</a></li><li><a href="Overlays.html#open">open</a></li></ul></div></li><li><a href="ToolSettings.html">ToolSettings</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ToolSettings_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ToolSettings.html#autoRecoverMessages">autoRecoverMessages</a></li><li><a href="ToolSettings.html#flashActions">flashActions</a></li><li><a href="ToolSettings.html#highlights">highlights</a></li><li><a href="ToolSettings.html#language">language</a></li><li><a href="ToolSettings.html#lightDesignMode">lightDesignMode</a></li><li><a href="ToolSettings.html#menu">menu</a></li><li><a href="ToolSettings.html#showBanAlert">showBanAlert</a></li><li><a href="ToolSettings.html#showFollowAlert">showFollowAlert</a></li><li><a href="ToolSettings.html#showHostAlert">showHostAlert</a></li><li><a href="ToolSettings.html#showLocalizedNames">showLocalizedNames</a></li><li><a href="ToolSettings.html#showRaidAlert">showRaidAlert</a></li><li><a href="ToolSettings.html#showSubscriptionAlert">showSubscriptionAlert</a></li><li><a href="ToolSettings.html#showTimeoutAlert">showTimeoutAlert</a></li><li><a href="ToolSettings.html#showViewerList">showViewerList</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ToolSettings.html#addHighlight">addHighlight</a></li><li><a href="ToolSettings.html#appendSetting">appendSetting</a></li><li><a href="ToolSettings.html#getBoolean">getBoolean</a></li><li><a href="ToolSettings.html#getJSON">getJSON</a></li><li><a href="ToolSettings.html#getString">getString</a></li><li><a href="ToolSettings.html#remove">remove</a></li><li><a href="ToolSettings.html#setBoolean">setBoolean</a></li><li><a href="ToolSettings.html#setJSON">setJSON</a></li><li><a href="ToolSettings.html#setLanguage">setLanguage</a></li><li><a href="ToolSettings.html#setString">setString</a></li></ul></div></li><li><a href="ToolUI.html">ToolUI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ToolUI_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ToolUI.html#currentPage">currentPage</a></li><li><a href="ToolUI.html#loadingElement">loadingElement</a></li><li><a href="ToolUI.html#pageBefore">pageBefore</a></li><li><a href="ToolUI.html#pages">pages</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ToolUI.html#addMenu">addMenu</a></li><li><a href="ToolUI.html#addPage">addPage</a></li><li><a href="ToolUI.html#findPage">findPage</a></li><li><a href="ToolUI.html#getMenuItemById">getMenuItemById</a></li><li><a href="ToolUI.html#openPage">openPage</a></li><li><a href="ToolUI.html#showErrorMessage">showErrorMessage</a></li><li><a href="ToolUI.html#startLoading">startLoading</a></li><li><a href="ToolUI.html#stopLoading">stopLoading</a></li></ul></div></li><li><a href="TTVLogin.html">TTVLogin</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TTVLogin_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TTVLogin.html#menu">menu</a></li><li><a href="TTVLogin.html#userid">userid</a></li><li><a href="TTVLogin.html#username">username</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="TTVLogin.html#auth">auth</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="TTVLogin.html#event:complete">complete</a></li></ul></div></li><li><a href="TTVTool.html">TTVTool</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TTVTool_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TTVTool.html#addons">addons</a></li><li><a href="TTVTool.html#auth">auth</a></li><li><a href="TTVTool.html#channel">channel</a></li><li><a href="TTVTool.html#chat">chat</a></li><li><a href="TTVTool.html#cockpit">cockpit</a></li><li><a href="TTVTool.html#follows">follows</a></li><li><a href="TTVTool.html#i18n">i18n</a></li><li><a href="TTVTool.html#overlays">overlays</a></li><li><a href="TTVTool.html#settings">settings</a></li><li><a href="TTVTool.html#subscriptions">subscriptions</a></li><li><a href="TTVTool.html#twitchapi">twitchapi</a></li><li><a href="TTVTool.html#ui">ui</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="TTVTool.html#event:exit">exit</a></li><li><a href="TTVTool.html#event:load">load</a></li></ul></div></li><li><a href="TwitchChat.html">TwitchChat</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TwitchChat_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TwitchChat.html#options">options</a></li><li><a href="TwitchChat.html#socket">socket</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="TwitchChat.html#join">join</a></li><li><a href="TwitchChat.html#part">part</a></li><li><a href="TwitchChat.html#say">say</a></li><li><a href="TwitchChat.html#sendCLRF">sendCLRF</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="TwitchChat.html#event:action">action</a></li><li><a href="TwitchChat.html#event:autohostingyou">autohostingyou</a></li><li><a href="TwitchChat.html#event:capack">capack</a></li><li><a href="TwitchChat.html#event:clearchat">clearchat</a></li><li><a href="TwitchChat.html#event:clearuser">clearuser</a></li><li><a href="TwitchChat.html#event:close">close</a></li><li><a href="TwitchChat.html#event:connect">connect</a></li><li><a href="TwitchChat.html#event:error">error</a></li><li><a href="TwitchChat.html#event:hostingyou">hostingyou</a></li><li><a href="TwitchChat.html#event:incoming">incoming</a></li><li><a href="TwitchChat.html#event:join">join</a></li><li><a href="TwitchChat.html#event:message">message</a></li><li><a href="TwitchChat.html#event:mode">mode</a></li><li><a href="TwitchChat.html#event:mode+">mode+</a></li><li><a href="TwitchChat.html#event:mode-">mode-</a></li><li><a href="TwitchChat.html#event:motd">motd</a></li><li><a href="TwitchChat.html#event:names">names</a></li><li><a href="TwitchChat.html#event:notice">notice</a></li><li><a href="TwitchChat.html#event:outgoing">outgoing</a></li><li><a href="TwitchChat.html#event:part">part</a></li><li><a href="TwitchChat.html#event:raw">raw</a></li><li><a href="TwitchChat.html#event:registered">registered</a></li><li><a href="TwitchChat.html#event:roomstate">roomstate</a></li><li><a href="TwitchChat.html#event:usernotice">usernotice</a></li><li><a href="TwitchChat.html#event:userstate">userstate</a></li><li><a href="TwitchChat.html#event:whisper">whisper</a></li></ul></div></li><li><a href="TwitchTv.html">TwitchTv</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TwitchTv_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TwitchTv.html#channelid">channelid</a></li><li><a href="TwitchTv.html#channelobj">channelobj</a></li><li><a href="TwitchTv.html#clientid">clientid</a></li><li><a href="TwitchTv.html#redirecturi">redirecturi</a></li><li><a href="TwitchTv.html#scope">scope</a></li><li><a href="TwitchTv.html#userid">userid</a></li><li><a href="TwitchTv.html#userobj">userobj</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="TwitchTv.html#getAuthImplicitGrantFlowUrl">getAuthImplicitGrantFlowUrl</a></li><li><a href="TwitchTv.html#getAuthToken">getAuthToken</a></li><li><a href="TwitchTv.html#getChannel">getChannel</a></li><li><a href="TwitchTv.html#getChannelFollowers">getChannelFollowers</a></li><li><a href="TwitchTv.html#getChannelSubscribers">getChannelSubscribers</a></li><li><a href="TwitchTv.html#getChannelVideos">getChannelVideos</a></li><li><a href="TwitchTv.html#getChatBadgesByChannel">getChatBadgesByChannel</a></li><li><a href="TwitchTv.html#getChatBadgeSetsByChannel">getChatBadgeSetsByChannel</a></li><li><a href="TwitchTv.html#getChatEmoticonsBySet">getChatEmoticonsBySet</a></li><li><a href="TwitchTv.html#getCollectionsByChannel">getCollectionsByChannel</a></li><li><a href="TwitchTv.html#getStreamByUser">getStreamByUser</a></li><li><a href="TwitchTv.html#getTeam">getTeam</a></li><li><a href="TwitchTv.html#getUser">getUser</a></li><li><a href="TwitchTv.html#getUserByName">getUserByName</a></li><li><a href="TwitchTv.html#getUserFollows">getUserFollows</a></li><li><a href="TwitchTv.html#isLoggedIn">isLoggedIn</a></li><li><a href="TwitchTv.html#requestAPI">requestAPI</a></li><li><a href="TwitchTv.html#searchGames">searchGames</a></li><li><a href="TwitchTv.html#setAuthToken">setAuthToken</a></li><li><a href="TwitchTv.html#updateChannel">updateChannel</a></li><li><a href="TwitchTv.html#verifyState">verifyState</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="TwitchTv.html#~requestCallback">requestCallback</a></li></ul></div></li><li><a href="UIPage.html">UIPage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UIPage_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UIPage.html#localizedName">localizedName</a></li><li><a href="UIPage.html#name">name</a></li><li><a href="UIPage.html#showInViewsList">showInViewsList</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UIPage.html#close">close</a></li><li><a href="UIPage.html#open">open</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict"

const {remote} = require('electron')
const {Menu, MenuItem} = remote

const UIPage = require('../mod/uipage')

/**
 * This module manages a few settings and gives you easy functions to
 * store your settings in the localStorage.
 * 
 * @class ToolSettings
 * @param {TTVTool} tool
 */
class ToolSettings extends UIPage {

	constructor(tool) {
		super('Settings')

		const self = this
		this._tool = tool
		this._appendOnLoad = []
		this._tool.on('load', () => {
			riot.mount(document.querySelector('#highlightdialog'))

			document.querySelector('#nav-settings').onclick = () => {
				self._tool.ui.openPage('Settings')
			}

			while(self._appendOnLoad.length > 0) {
				let s = self._appendOnLoad.shift()
				self.appendSetting(s.setting, s.label, s.type, s.options)
			}

			self.appendSetting('language', self._tool.i18n.__('Language'), 'select', { selection: { 'en': 'English', 'de': 'Deutsch' }, onchange: () => { self._tool.ui.showErrorMessage(new Error('You need to restart TTVStreamerTool for the language change to take effect.')) }, default: 'en' })
			self.appendSetting('autorecovermessages', self._tool.i18n.__('Autorecover deleted messages'), 'checkbox', { default: false })
			self.appendSetting('showlocalizednames', self._tool.i18n.__('Show localized display names'), 'checkbox', { default: true })
			self.appendSetting('showviewerlist', self._tool.i18n.__('Show viewer list'), 'checkbox', { default: true })

			self.appendSetting('flashactions', self._tool.i18n.__('Flash alerts'), 'checkbox', { set: 'alert_options', setLabel: self._tool.i18n.__('Alert options'), default: true })
			self.appendSetting('', '', 'separator', { set: 'alert_options' })
			self.appendSetting('showfollowalert', self._tool.i18n.__('Show follow alerts'), 'checkbox', { set: 'alert_options', default: true })
			self.appendSetting('showsubscriptionalert', self._tool.i18n.__('Show subscription alerts'), 'checkbox', { set: 'alert_options', default: true })
			self.appendSetting('showraidalert', self._tool.i18n.__('Show raid alerts'), 'checkbox', { set: 'alert_options', default: true })
			self.appendSetting('showhostalert', self._tool.i18n.__('Show host alerts'), 'checkbox', { set: 'alert_options', default: true })
			self.appendSetting('showbanalert', self._tool.i18n.__('Show ban alerts'), 'checkbox', { set: 'alert_options', default: true })
			self.appendSetting('showtimeoutalert', self._tool.i18n.__('Show timeout alerts'), 'checkbox', { set: 'alert_options', default: true })

			self.appendSetting('tw_auth_token', self._tool.i18n.__('Logout'), 'button', { set: 'twitch', setLabel: 'Twitch', description: self._tool.i18n.__('Click this button to log out of twitch. You will prompted to login again.'), onclick: () => {
				self.remove('tw_auth_token')
				window.location.reload()
			} })

			self.create_highlight_settings()
		})
	}

	get localizedName() {
		return this._tool.i18n.__('Settings')
	}

	get showInViewsList() { return false }

	open() {
		document.querySelector('#content_settings').style.display = "block";
	}
	close() {
		document.querySelector('#content_settings').style.display = "none";
	}

	/**
	 * 
	 * @param {String} setting 
	 * @param {String} label 
	 * @param {String} type 
	 * @param {Object} options 
	 */
	appendSetting(setting, label, type, options) {
		const self = this

		type = type.toLowerCase()
		if(['text', 'checkbox', 'select', 'password', 'separator', 'button'].indexOf(type) &lt; 0) return
		if((setting.length &lt;= 0 || label.length &lt;= 0) &amp;&amp; type != 'separator') return

		let options_default = {
			set: 'unsorted',
			setLabel: '',
			description: '',
			selection: {},
			onchange: null,
			onclick: null,
			default: null
		}
		if(typeof(options) == 'object') {
			options = Object.assign(options_default, options)
		} else {
			options = options_default
		}

		let content_settings = document.querySelector('#content_settings')
		if(content_settings === null) {
			this._appendOnLoad.push({setting: setting, label: label, type: type, options: options})
			return
		}

		// Getting the fieldset the option belongs to or creates a new one if it doesn't exist
		let settings_set = document.querySelector('#settings_set_' + options.set)
		if(settings_set === null) {
			let fieldsetElement = document.createElement('fieldset')
			fieldsetElement.id = 'settings_set_' + options.set
			if(options.setLabel.length > 0) { // No legend with an empty label
				let setlabel = document.createElement('legend')
				setlabel.innerText = options.setLabel
				fieldsetElement.appendChild(setlabel)
			}
			content_settings.appendChild(fieldsetElement)
			settings_set = fieldsetElement
		}

		if(type == 'separator') {
			settings_set.appendChild(document.createElement('hr'))
			return
		}


		let labelElement = document.createElement('label')
		let inputElement = null
		if(type == 'select') {
			inputElement = document.createElement('select')
			for(let index in options.selection) {
				if(!options.selection.hasOwnProperty(index)) continue

				let optionElement = document.createElement('option')
				optionElement.value = index
				optionElement.innerText = options.selection[index]
				if(this.getString(setting) == index) {
					optionElement.setAttribute('selected', true)
				}
				inputElement.appendChild(optionElement)
			}
		} else if(type == 'button') {
			inputElement = document.createElement('button')
			inputElement.innerText = label
			if(typeof(options.onclick) !== 'function') {
				return
			}
			inputElement.addEventListener('click', options.onclick)
		} else {
			inputElement = document.createElement('input')
			inputElement.setAttribute('type', type)
			if(type == 'checkbox') {
				if(this.getBoolean(setting, (typeof(options.default) !== 'boolean' ? false : options.default))) {
					inputElement.setAttribute('checked', this.getBoolean(setting))
				}
			} else {
				inputElement.value = this.getString(setting)
			}
		}

		inputElement.dataset.setting = setting


		if(typeof(options.onchange) === 'function') {
			inputElement.addEventListener('change', options.onchange)
		}
		inputElement.addEventListener('change', () => {
			if(type == 'checkbox') {
				self.setBoolean(setting, inputElement.checked)
			} else {
				self.setString(setting, inputElement.value)
			}
		})

		let descriptionElement = null
		if(options.description.length > 0) {
			descriptionElement = document.createElement('small')
			descriptionElement.innerText = options.description
		}

		if(type == 'checkbox') {
			labelElement.classList.add('win10-switch')
			labelElement.appendChild(inputElement)
			labelElement.appendChild(document.createTextNode(label))
			if(descriptionElement != null) {
				labelElement.appendChild(document.createElement('br'))
				labelElement.appendChild(descriptionElement)
			}
		} else if(type == 'button') {
			labelElement.appendChild(inputElement)
			if(descriptionElement != null) {
				labelElement.appendChild(document.createElement('br'))
				labelElement.appendChild(descriptionElement)
			}
		} else {
			labelElement.appendChild(document.createTextNode(label))
			labelElement.appendChild(inputElement)
			if(descriptionElement != null) {
				labelElement.appendChild(descriptionElement)
			}
		}

		settings_set.appendChild(labelElement)
	}

	/**
	 * Loads and returns the selected application language.
	 * 
	 * @member {String}
	 * @readonly
	 */
	get language() {
		return this.getString('language', 'en')
	}

	/**
	 * Loads and returns weither or not localized names should be displayed.
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showLocalizedNames() {
		return this.getBoolean('showlocalizednames', true)
	}

	/**
	 * Loads and returns weither or not to auto recover deleted messages.
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get autoRecoverMessages() {
		return this.getBoolean('autorecovermessages', false)
	}

	/**
	 * Loads and returns weither or not to animate actions in the action bar
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get flashActions() {
		return this.getBoolean('flashactions', true)
	}

	/**
	 * Loads and returns weither or not to show follow alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showFollowAlert() {
		return this.getBoolean('showfollowalert', true)
	}
	/**
	 * Loads and returns weither or not to show subscription alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showSubscriptionAlert() {
		return this.getBoolean('showsubscriptionalert', true)
	}
	/**
	 * Loads and returns weither or not to show raid alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showRaidAlert() {
		return this.getBoolean('showraidalert', true)
	}
	/**
	 * Loads and returns weither or not to show host alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showHostAlert() {
		return this.getBoolean('showhostalert', true)
	}
	/**
	 * Loads and returns weither or not to show ban alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showBanAlert() {
		return this.getBoolean('showbanalert', true)
	}
	/**
	 * Loads and returns weither or not to show timeout alerts
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showTimeoutAlert() {
		return this.getBoolean('showtimeoutalert', true)
	}

	/**
	 * Loads and returns weither or not to show the viewers list
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get showViewerList() {
		return this.getBoolean('showviewerlist', true)
	}

	/**
	 * Loads and returns an array of configured highlight objects.
	 * 
	 * @member {Array}
	 * @readonly
	 */
	get highlights() {
		return this.getJSON('highlights', [])
	}

	/**
	 * Loads and returns weither or not to invert the application's colors
	 * 
	 * @member {Boolean}
	 * @readonly
	 */
	get lightDesignMode() {
		return this.getBoolean('lightdesignmode', false)
	}

	/**
	 * Creates and returns a settings menu. This always creates a new MenuItem.
	 * If you want access to the items in the application menu use
	 * getMenuItemById of the ToolUI.
	 * 
	 * @member {MenuItem}
	 * @readonly
	 */
	get menu() {
		const self = this
		return new MenuItem({
			label: this._tool.i18n.__('Settings'),
			submenu: Menu.buildFromTemplate([
				{
					label: this._tool.i18n.__('Language'),
					submenu: [
						{
							label: 'English',
							type: 'radio',
							id: 'menu_language_en',
							checked: (this.language == 'en' ? true : false),
							click() {
								self.setLanguage('en')
							}
						},
						{
							label: 'Deutsch',
							type: 'radio',
							id: 'menu_language_de',
							checked: (this.language == 'de' ? true : false),
							click() {
								self.setLanguage('de')
							}
						}
					]
				},
				{
					label: this._tool.i18n.__('Autorecover deleted messages'),
					type: 'checkbox',
					id: 'menu_autorecovermessages',
					checked: this.autoRecoverMessages,
					click() {
						self.setBoolean('autorecovermessages', !self.autoRecoverMessages)
						self._tool.ui.getMenuItemById('menu_autorecovermessages').checked = self.autoRecoverMessages
					}
				},
				{
					label: this._tool.i18n.__('Show localized display names'),
					type: 'checkbox',
					id: 'menu_localizednames',
					checked: this.showLocalizedNames,
					click() {
						self.setBoolean('showlocalizednames', !self.showLocalizedNames)
						self._tool.ui.getMenuItemById('menu_localizednames').checked = self.showLocalizedNames
					}
				},
				{
					label: this._tool.i18n.__('Show viewer list'),
					type: 'checkbox',
					id: 'menu_showviewerlist',
					checked: this.showViewerList,
					click() {
						self.setBoolean('showviewerlist', !self.showViewerList)
						if(!self.showViewerList) {
							document.querySelector('#chat_column').style.width = '70%'
							document.querySelector('#chat_users_column').style.display = 'none'
							document.querySelector('#chat_message_column').style.width = '70%'
							document.querySelector('#chat_message_emotes_button').style.right = 'calc(30% + 8px)'
							document.querySelector('#chat_message_emotes').style.right = 'calc(30% + 8px)'
						} else {
							document.querySelector('#chat_column').style.width = '50%'
							document.querySelector('#chat_users_column').style.display = 'block'
							document.querySelector('#chat_message_column').style.width = '50%'
							document.querySelector('#chat_message_emotes_button').style.right = 'calc(50% + 8px)'
							document.querySelector('#chat_message_emotes').style.right = 'calc(50% + 8px)'
						}
					}
				},
				{
					label: this._tool.i18n.__('Alert options'),
					submenu: [
						{
							label: this._tool.i18n.__('Flash alerts'),
							type: 'checkbox',
							id: 'menu_flashalerts',
							checked: this.flashActions,
							click() {
								self.setBoolean('flashactions', !self.flashActions)
							}
						},
						{ type: 'separator' },
						{
							label: this._tool.i18n.__('Show follow alerts'),
							type: 'checkbox',
							id: 'menu_showfollowalerts',
							checked: this.showFollowAlert,
							click() { self.setBoolean('showfollowalert', !self.showFollowAlert) }
						},
						{
							label: this._tool.i18n.__('Show subscription alerts'),
							type: 'checkbox',
							id: 'menu_showsubscriptionalerts',
							checked: this.showSubscriptionAlert,
							click() { self.setBoolean('showsubscriptionalert', !self.showSubscriptionAlert) }
						},
						{
							label: this._tool.i18n.__('Show raid alerts'),
							type: 'checkbox',
							id: 'menu_showraidalerts',
							checked: this.showRaidAlert,
							click() { self.setBoolean('showraidalert', !self.showRaidAlert) }
						},
						{
							label: this._tool.i18n.__('Show host alerts'),
							type: 'checkbox',
							id: 'menu_showhostalerts',
							checked: this.showHostAlert,
							click() { self.setBoolean('showhostalert', !self.showHostAlert) }
						},
						{
							label: this._tool.i18n.__('Show ban alerts'),
							type: 'checkbox',
							id: 'menu_showbanalerts',
							checked: this.showBanAlert,
							click() { self.setBoolean('showbanalert', !self.showBanAlert) }
						},
						{
							label: this._tool.i18n.__('Show timeout alerts'),
							type: 'checkbox',
							id: 'menu_showtimeoutalerts',
							checked: this.showTimeoutAlert,
							click() { self.setBoolean('showtimeoutalert', !self.showTimeoutAlert) }
						}
					]
				},
				{
					label: this._tool.i18n.__('Highlights'),
					id: 'menu_highlights',
					submenu: this.create_highlight_menu()
				},
				{
					label: this._tool.i18n.__('Light design mode'),
					type: 'checkbox',
					checked: this.lightDesignMode,
					click() {
						self.setBoolean('lightdesignmode', !self.lightDesignMode)
						if(!self.lightDesignMode) {
							document.querySelector('body').classList.remove('invert')
						} else {
							document.querySelector('body').classList.add('invert')
						}
					}
				}
			])
		})
	}


	/**
	 * Sets the application language to lang. Please don't use this without explicit user interaction.
	 * 
	 * @param {String} lang The short i18n languge description. Currently only en and de are really supported.
	 */
	setLanguage(lang) {
		this.setString('language', lang)

		this._tool.ui.showErrorMessage(new Error('You need to restart TTVStreamerTool for the language change to take effect.'))
	}

	/**
	 * Opens the dialog to add a new highlight.
	 */
	addHighlight() {
		const self = this
		document.querySelector('#highlightdialog').style.display = 'table'
		document.querySelector('#highlightdialog_phrase').value = ''
		this._chrsel = () => { self.checkHighlightRegexSyntax() }
		document.querySelector('#highlightdialog_phrase').addEventListener('keyup', this._chrsel)
		document.querySelector('#highlightdialog_regex').checked = false
		document.querySelector('#highlightdialog_casesensitive').checked = false
	}

	/**
	 * Checks if the regex in the new highlight dialog is valid.
	 * 
	 * @private
	 * @returns {Boolean}
	 */
	checkHighlightRegexSyntax() {
		if(!document.querySelector('#highlightdialog_regex').checked) return true

		let rx = document.querySelector('#highlightdialog_phrase').value
		try {
			let r = new RegExp(rx)
			document.querySelector('#highlightdialog_errors').innerText = ''
			return true
		} catch(err) {
			document.querySelector('#highlightdialog_errors').innerText = err.message
			return false
		}
	}

	/**
	 * Hides the dialog to add a new highlight.
	 * 
	 * @private
	 */
	cancelNewHighlight() {
		document.querySelector('#highlightdialog').style.display = 'none'
	}

	/**
	 * Saves the currently entered new Highlight and hides the dialog.
	 * 
	 * @private
	 */
	saveNewHighlight() {
		const self = this
		document.querySelector('#highlightdialog_phrase').removeEventListener('keyup', this._chrsel)
		document.querySelector('#highlightdialog').style.display = 'none'

		let phrase = document.querySelector('#highlightdialog_phrase').value
		let regex = document.querySelector('#highlightdialog_regex').checked
		let casesensitive = document.querySelector('#highlightdialog_casesensitive').checked
		let id = 'highlight_' + (regex ? 'regex_' : 'noregex_') + phrase + (casesensitive ? '_casesensitive' : '_caseinsensitive')

		if(phrase.length > 0 &amp;&amp; this.checkHighlightRegexSyntax()) {
			let doesexist = false
			let highlights = this.highlights
			/*for(let i = 0; i &lt; highlights.length; i++) {
				if(highlights[i].id == item.id)
					doesexist = true
			}*/
			if(!doesexist) {
				highlights.push({ phrase: phrase, regex: regex, casesensitive: casesensitive, id: id })
				this._tool.ui.getMenuItemById('menu_highlights').submenu.append(new MenuItem({
					label: phrase,
					id: id,
					click(item) { self.removeHighlight(item) }
				}))
				this.setJSON('highlights', highlights)
				this.create_highlight_settings()
			}
		}
	}

	/**
	 * Removes a highlight by its menu entry. Will show a confirm dialog to the user.
	 * 
	 * @param {MenuItem} item 
	 * @private
	 */
	removeHighlight(item) {
		if(confirm(this._tool.i18n.__('Are you sure you want do delete this highlight?'))) {
			item.visible = false
			let highlights = this.highlights
			for(var i = 0; i &lt; highlights.length; i++) {
				if(highlights[i].id == item.id) {
					highlights.splice(i, 1)
					this.setJSON('highlights', highlights)
					this.create_highlight_settings()
					break
				}
			}
		}
	}

	/**
	 * Generates a highlight menu template for the menu generation.
	 * 
	 * @returns {Array}
	 * @private
	 */
	create_highlight_menu() {
		const self = this
		let highlight_menu = [
			{
				label: this._tool.i18n.__('Add a highlighter'),
				click() { self.addHighlight() }
			},
			{ type: 'separator' }
		]
		let highlights = this.highlights
		for(var i = 0; i &lt; highlights.length; i++) {
			highlight_menu.push({
				label: highlights[i].phrase,
				id: highlights[i].id,
				click(item) { self.removeHighlight(item) }
			})
		}

		return highlight_menu
	}

	create_highlight_settings() {
		const self = this

		let content_settings = document.querySelector('#content_settings')
		let settings_set = document.querySelector('#settings_set_highlights')
		if(settings_set === null) {
			let fieldsetElement = document.createElement('fieldset')
			fieldsetElement.id = 'settings_set_highlights'
			content_settings.appendChild(fieldsetElement)
			settings_set = fieldsetElement
		}
		settings_set.innerHTML = ''

		let setlabel = document.createElement('legend')
		setlabel.innerText = this._tool.i18n.__('Highlights')
		settings_set.appendChild(setlabel)

		let addLink = document.createElement('button')
		addLink.innerText = this._tool.i18n.__('Add a highlighter')
		addLink.addEventListener('click', () => {
			self.addHighlight()
		})
		settings_set.appendChild(addLink)
		settings_set.appendChild(document.createElement('hr'))

		
		let highlights = this.highlights
		let linkList = document.createElement('ul')
		linkList.classList.add('linklist')
		for(var i = 0; i &lt; highlights.length; i++) {
			let listElement = document.createElement('li')
			let aElement = document.createElement('a')
			aElement.innerText = highlights[i].phrase
			let highlightid = highlights[i].id
			aElement.addEventListener('click', () => { self.removeHighlight({ id: highlightid }) })
			listElement.appendChild(aElement)
			linkList.appendChild(listElement)
		}

		settings_set.appendChild(linkList)
	}

	/**
	 * Load a boolean from the localStorage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {Boolean} defaultValue The default value you want returned if storage value was not found
	 */ 
	getBoolean(name, defaultValue) {
		let item = window.localStorage.getItem(name)
		if(item != null) {
			if(item == 'true') {
				return true
			} else if(item == 'false') {
				return false
			}
		}
		return defaultValue
	}

	/**
	 * Sets a boolean to the localStorage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {Boolean} value The value you want to set
	 */
	setBoolean(name, value) {
		window.localStorage.setItem(name, (value ? 'true' : 'false'))
	}

	/**
	 * Gets a string from the localStorage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {String} defaultValue The default value you want returned if storage value was not found
	 */
	getString(name, defaultValue) {
		let item = window.localStorage.getItem(name)
		if(item != null) {
			return item
		}

		return defaultValue
	}

	/**
	 * Sets a string to the localStroage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {String} value The value you want to set
	 */
	setString(name, value) {
		window.localStorage.setItem(name, value)
	}

	/**
	 * Gets a object from the localStorage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {Object} defaultValue The default value you want returned if storage value was not found
	 */
	getJSON(name, defaultValue) {
		let item = window.localStorage.getItem(name)
		if(item != null) {
			try {
				return JSON.parse(item)
			} catch(e) { console.error(e) }
		}
		return defaultValue
	}

	/**
	 * Sets a JSON object to the localStorage.
	 * 
	 * @param {String} name Name of the localStorage value
	 * @param {Object} value The value you want to set
	 */
	setJSON(name, value) {
		try {
			window.localStorage.setItem(name, JSON.stringify(value))
		} catch(e) { console.error(e) }
	}

	/**
	 * Removes an item in the localStorage
	 * 
	 * @param {String} name 
	 */
	remove(name) {
		window.localStorage.removeItem(name)
	}

}

module.exports = ToolSettings</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="width: 0px; height: 0px">
    <div class="footer-text">Code by PakL</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
